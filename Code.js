"use strict";(()=>{var z=(e,s="none")=>{let n=!1,t=!1;switch(e){case"settings":t=!0;case"stage":n=!0;break;case"research":(a.stage.true>1||a.discharge.current>=4)&&(n=!0,(s==="researches"||a.stage.current===4&&a.upgrades[1]===1)&&(t=!0));break;case"special":n=o.screenReader;break}return s!=="none"?t:n},ge=e=>{let s=!1;switch(a.stage.current){case 1:case 2:s=!0;break;case 3:(e===1||a.upgrades[(e-1)*2]===1)&&(s=!0);break;case 4:if(a.collapse.mass<o.collapseInfo.unlockPriceB[e])return!1;(e===1||e===4||a.upgrades[e-1]===1)&&(s=!0)}return s};var k=(e,s=!1)=>{let{stage:n,buildings:t}=a,{buildingsInfo:i,screenReader:l}=o;if(!ge(e))return;if(!isFinite(i.cost[e])){l&&!s&&(r("invisibleBought").textContent=`Coudn't buy '${i.name[e]}', because cost is infinity`);return}let f=e-1;n.current===2&&e!==1?f=1:(n.current===3||n.current===4)&&(f=0);let c=2;if(t[e].true===0&&(c=1),t[f].current/(s?c:1)<i.cost[e]){l&&!s&&(r("invisibleBought").textContent=`Coudn't buy '${i.name[e]}', because didn't had enough of '${i.name[f]}'`);return}let{researchesAuto:u}=a,{shop:m}=a.toggles,g=s?-1:m.howMany;if(n.current===1&&(o.dischargeInfo.energyType[e]=w.dischargeInfo.energyType[e]*3**a.researches[4]),g!==1&&u[0]>0){let B=t[f].current/(s?c:1),v=i.startCost[e]*((i.increase[e]**t[e].true-1)/(i.increase[e]-1)),h=Math.trunc(Math.log((v+B)*(i.increase[e]-1)/i.startCost[e]+1)/Math.log(i.increase[e]))-t[e].true;if(m.strict&&h<g&&g!==-1)return;let p=g!==-1?Math.min(h,g):h,T=i.startCost[e]*((i.increase[e]**(p+t[e].true)-1)/(i.increase[e]-1))-v;t[f].current-=T,t[e].current+=p,t[e].true+=p,t[e].total+=p,t[e].trueTotal+=p,n.current===1&&(a.discharge.energyCur+=o.dischargeInfo.energyType[e]*p),o.screenReader&&!s&&(r("invisibleBought").textContent=`Bought ${d(p)} '${i.name[e]}'${n.current===1?`, gained ${d(o.dischargeInfo.energyType[e]*p)} ${o.stageInfo.resourceName[n.current-1]}`:""}`)}else t[f].current-=i.cost[e],t[e].current++,t[e].true++,t[e].total++,t[e].trueTotal++,n.current===1&&(a.discharge.energyCur+=o.dischargeInfo.energyType[e]),o.screenReader&&(r("invisibleBought").textContent=`Bought 1 '${i.name[e]}'${n.current===1?`, gained ${d(o.dischargeInfo.energyType[e])} ${o.stageInfo.resourceName[n.current-1]}`:""}`);R(e),U(),D()},R=e=>{let{stage:s,buildings:n,upgrades:t,researches:i}=a,{buildingsInfo:l}=o;s.current===1?(o.upgradesInfo.effect[4]=Math.trunc((.2+i[0]*.01)*100)/100,l.increase[e]=Math.trunc((1.4-(t[4]===1?o.upgradesInfo.effect[4]:0))*100)/100,e===1&&(l.startCost[1]=w.buildingsInfo.startCost[1]/(t[0]===1?10:1))):s.current===3&&e===4?l.increase[4]=t[10]===1?5:10:s.current===4&&(l.increase[e]=Math.round((1.4+.15*(e-1)-(a.elements[2]===1?.1:0)-(a.elements[8]===1?.05:0))*100)/100,l.startCost[e]=w.buildingsInfo.startCost[e]/(a.elements[13]===1?1e3:1)),l.cost[e]=l.startCost[e]*l.increase[e]**n[e].true},Q=(e,s)=>{let{stage:n}=a,t="researchesAutoInfo";if(s!=="researchesAuto"&&(t=`${s}${n.current>1?`S${n.current}`:""}Info`),a[s][e]!==o[t].max[e])if(n.current===1?o[t].cost[e]=w[t].cost[e]+o[t].scaling[e]*a[s][e]:(o[t].cost[e]=w[t].cost[e]*o[t].scaling[e]**a[s][e],t==="researchesAutoInfo"&&e===1&&(n.current===2&&a.researchesAuto[1]>=3?o[t].cost[e]*=a.researchesAuto[1]>=4?1e4:100:n.current===3&&a.researchesAuto[1]>=2&&(o[t].cost[e]=a.researchesAuto[1]>=3?2e30:5e29))),o[t].cost[e]<1){let i=-Math.floor(Math.log10(o[t].cost[e]));o[t].cost[e]=Math.round(o[t].cost[e]*10**(i+2))/10**(i+2)}else o[t].cost[e]<1e3?o[t].cost[e]=Math.round(o[t].cost[e]*100)/100:o[t].cost[e]=Math.round(o[t].cost[e])},$=(e,s)=>{let{stage:n,buildings:t}=a,{buildingsInfo:i}=o,l;if(n.current===1&&e===3?l=o.upgradesInfo.effect[6]*s:(l=i.producing[e+1]*s,n.current===2&&e===1&&a.researchesExtra[1]>=1&&(l+=s*o.researchesExtraS2Info.effect[1])),l===0)return;n.current===4&&(e=0);let f=t[e].current+l;if(isFinite(f))t[e].current=f;else return;if(f=t[e].total+l,isFinite(f))t[e].total=f;else return;f=t[e].trueTotal+l,isFinite(f)&&(t[e].trueTotal=f)},S=(e,s="upgrades",n=0)=>{let{stage:t}=a;if(n!==0&&n!==t.current)return;let i;if(t.current===1?i=a.discharge.energyCur:t.current===2?i=a.buildings[1].current:i=a.buildings[0].current,s!=="upgrades"&&s!=="elements"){let l="researchesAutoInfo";if(s!=="researchesAuto"&&(l=`${s}${t.current>1?`S${t.current}`:""}Info`),a[s][e]===o[l].max[e]||i<o[l].cost[e])return;if(s==="researchesAuto"){if(e===2&&t.current!==2)return}else if(s==="researches"&&t.current===4&&o.collapseInfo.unlockPriceR[e]>a.collapse.mass)return;if(a[s][e]++,i-=o[l].cost[e],t.current===1&&s==="researches"&&e===0)for(let f=1;f<o.buildingsInfo.name.length;f++)R(f);else t.current===4&&s==="researches"&&e===2&&P(0,"researches");o.screenReader&&(r("invisibleBought").textContent=`You have researched '${o[l].description[e]}', level is now ${a[s][e]} ${a[s][e]===o[l].max[e]?"maxed":""}`),Q(e,s)}else{let l="elementsInfo";if(s!=="elements"&&(l=`${s}${t.current>1?`S${t.current}`:""}Info`),a[s][e]===1||i<o[l].cost[e])return;if(s==="upgrades"&&t.current===4&&o.collapseInfo.unlockPriceU[e]>a.collapse.mass)return;if(a[s][e]=1,i-=o[l].cost[e],s==="upgrades")if(t.current===1){if(e===0)R(1);else if(e===4)for(let f=1;f<o.buildingsInfo.name.length;f++)R(f)}else t.current===3&&e===10&&R(4);else if(s==="elements")if(a.collapse.show<e&&(a.collapse.show=e),e===2||e===8||e===13)for(let f=1;f<o.buildingsInfo.name.length;f++)R(f);else e===7||e===16||e===20||e===25?P(1,"researches"):e===9||e===17?P(0,"researches"):e===11&&P(2,"researches");o.screenReader&&(r("invisibleBought").textContent=`You have ${s!=="elements"?"bought upgrade":"obtained element"} '${o[l].description[e]}'`)}t.current===1?a.discharge.energyCur=i:t.current===2?a.buildings[1].current=i:a.buildings[0].current=i,D(),y(e,s),A(e,s)},P=(e,s)=>{let{stage:n}=a;if(s==="researchesAuto"&&e===1)o.researchesAutoInfo.max[1]=o.buildingsInfo.name.length-1;else if(n.current===3&&s==="researchesExtra"&&e===0)o.researchesExtraS3Info.max[0]=a.accretion.rank<=2?12:29;else if(n.current===4&&s==="researches")if(e===0)o.researchesS4Info.max[0]=3+3*a.researches[2],a.elements[9]===1&&(o.researchesS4Info.max[0]+=12),a.elements[17]===1&&(o.researchesS4Info.max[0]+=27);else if(e===1){o.researchesS4Info.max[1]=2,a.elements[7]===1&&(o.researchesS4Info.max[1]+=2);for(let t of[16,20,25])a.elements[t]===1&&(o.researchesS4Info.max[1]+=1)}else e===2&&(o.researchesS4Info.max[2]=a.elements[11]===1?2:1);Q(e,s),A(e,s)},G=(e,s,n=!1)=>{var l,f,c,u;let{toggles:t}=a,i;s==="normal"?i=r(`toggle${e}`):s==="buildings"?i=r(`toggleBuilding${e}`):i=r(`toggleAuto${e}`),n&&(t[s][e]=!t[s][e]),s==="normal"?t[s][e]?(i.textContent="ON",i.style.color="",i.style.borderColor="",o.screenReader&&(i.ariaLabel=(u=(c=i.ariaLabel)==null?void 0:c.replace(" OFF"," ON"))!=null?u:"")):(i.textContent="OFF",i.style.color="var(--red-text-color)",i.style.borderColor="crimson",o.screenReader&&(i.ariaLabel=(f=(l=i.ariaLabel)==null?void 0:l.replace(" ON"," OFF"))!=null?f:"")):t[s][e]?(i.textContent="Auto ON",i.style.color="",i.style.borderColor=""):(i.textContent="Auto OFF",i.style.color="var(--red-text-color)",i.style.borderColor="crimson")},W=(e="none")=>{let{shop:s}=a.toggles,n=r("buyAnyInput");switch(e){case"1":s.howMany=1;break;case"max":s.howMany=-1;break;case"any":s.input=Math.max(Math.trunc(Number(n.value)),-1),s.input===0&&(s.input=1),s.howMany=s.input,n.value=d(s.input,0,"input");break;case"strict":s.strict=!s.strict;break;default:n.value=d(s.input,0,"input")}r("buyStrict").style.borderColor=s.strict?"":"crimson",r("buyStrict").style.color=s.strict?"":"var(--red-text-color)",r("buy1x").style.backgroundColor=s.howMany===1?"green":"",r("buyAny").style.backgroundColor=Math.abs(s.howMany)!==1?"green":"",r("buyMax").style.backgroundColor=s.howMany===-1?"green":"",D()},de=async()=>{let{stage:e,buildings:s,researchesAuto:n,toggles:t}=a,i=!1,l=`Ready to enter next stage? Next one will be harder than current.
You might want to turn off all auto's first`;if(e.current===1)if(s[3].current>=167e19){let f=!0;t.normal[1]&&(f=await L(l)),f&&(n[0]===0&&n[0]++,i=!0)}else return x("You will need a single Drop of water for next one");else if(e.current===2)if(s[1].current>=1194e26){let f=!0;t.normal[1]&&(f=await L(l)),f&&(n[2]===0&&n[2]++,a.accretion.rank=0,i=!0)}else return x("Look's like, it, should have even more Drops");else if(e.current===3)if(s[0].current>=247e29){let f=!0;t.normal[1]&&(f=await L(l)),f&&(i=!0)}else return x("Self sustaining is not yet possible, need more Mass");else if(e.current===4)return x("Let's see the limit");i&&(n[1]=0,e.resets++,e.current++,e.true<e.current&&e.true++,N("stage"))},me=async()=>{let{dischargeInfo:e}=o;if(a.upgrades[3]===1&&a.buildings[1].true>0){let{discharge:s}=a,n=!0;a.toggles.normal[2]&&(s.energyCur<e.next?n=await L("This will reset all of your current buildings and energy. You will NOT gain production boost. Continue?"):n=await L("You have enough energy to gain boost. Continue?")),n&&(s.energyCur>=e.next?(s.current++,Math.round(e.next*=10),o.screenReader&&(r("invisibleBought").textContent="Buildings and energy were reset for some boost")):o.screenReader&&s.energyCur<e.next&&(r("invisibleBought").textContent="Buildings and energy were reset, no boost"),N("discharge"))}},pe=async()=>{let{vaporizationInfo:e}=o;if(a.upgrades[1]===1&&e.get>=1){let{vaporization:s}=a,n=!0;a.toggles.normal[3]&&(n=await L(`Do you wish to reset buildings and upgrades for ${d(e.get)} Clouds?`)),n&&(s.clouds+=e.get,N("vaporization"),o.screenReader&&(r("invisibleBought").textContent=`Progress were reset for ${d(e.get)} Clouds`))}},he=async()=>{let{accretionInfo:e}=o,{accretion:s}=a;if(a.buildings[0].current>=e.rankCost[s.rank]&&e.rankCost[s.rank]!==0){let n=!0;a.toggles.normal[4]&&s.rank!==0&&(n=await L("Increasing Rank will reset buildings, upgrades, stage researches. But you will get closer to your goal")),n&&(s.rank++,N("rank"),P(0,"researchesExtra"),ne(),o.screenReader&&(r("invisibleBought").textContent=`Rank is now ${e.rankName[s.rank]}`))}},ye=async()=>{let{collapseInfo:e}=o,{collapse:s}=a;if(e.newMass>=s.mass){let{researchesExtra:n}=a,t=!0;if(a.toggles.normal[5]){let i=`This will reset all non automization researches and upgrades. ${e.newMass===s.mass?"Your total Mass won't change":`But your total Mass will be now ${d(e.newMass)}`}`;n[0]>=1&&(i+=`, also you will get ${d(e.starCheck[0])} Red giants`,n[0]>=2&&(i+=`, ${d(e.starCheck[1])} Neutron stars`,n[0]>=3&&(i+=` and ${d(e.starCheck[2])} Black holes`))),t=await L(i)}if(t){s.mass=e.newMass;for(let i=0;i<n[0];i++)s.stars[i]+=e.starCheck[i];if(N("collapse"),P(0,"researches"),P(1,"researches"),P(2,"researches"),o.screenReader){let i=`Your Mass has increased to ${d(s.mass)}`;n[0]>=1&&(i+=`, Red giants to ${d(s.stars[0])}`,n[0]>=2&&(i+=`, Neutron stars - ${d(s.stars[1])}`,n[0]>=3&&(i+=` and Black holes - ${d(s.stars[2])}`))),r("invisibleBought").textContent=i}}}};var I=(e,s="tabOnly")=>{if(o.tab!==e&&s==="tabOnly"){if(r(`${o.tab}Tab`).style.display="none",r(`${o.tab}TabBtn`).classList.remove("tabActive"),Object.hasOwn(o.subtab,o.tab+"Current"))for(let t of o.tabList[o.tab+"Subtabs"])r(`${o.tab}SubtabBtn${t}`).style.display="none";o.tab=e;let n=0;if(r(`${e}Tab`).style.display="",r(`${e}TabBtn`).classList.add("tabActive"),Object.hasOwn(o.subtab,e+"Current"))for(let t of o.tabList[e+"Subtabs"])z(e,t)?(r(`${e}SubtabBtn${t}`).style.display="",n++):o.subtab[e+"Current"]===t&&I(e,w.subtab[e+"Current"]);r("subtabs").style.display=n>=2?"":"none",r("invisibleTab").textContent=`Current tab is ${o.tab} tab${n>=2?` and its subtab is ${o.subtab[e+"Current"]}`:""}`}else s!=="tabOnly"&&s!==o.subtab[e+"Current"]&&(r(`${e}Subtab${o.subtab[e+"Current"]}`).style.display="none",r(`${e}SubtabBtn${o.subtab[e+"Current"]}`).classList.remove("tabActive"),o.subtab[e+"Current"]=s,r(`${e}Subtab${o.subtab[e+"Current"]}`).style.display="",r(`${e}SubtabBtn${o.subtab[e+"Current"]}`).classList.add("tabActive"),o.screenReader&&o.tab===e&&(r("invisibleTab").textContent=`Current subtab is ${o.subtab[e+"Current"]}, part of ${e} tab`));ee(),D()},F=()=>o.timeSpecial.maxOffline=7200+7200*a.researchesAuto[2],U=(e=0)=>{let{stage:s,time:n,buildings:t,upgrades:i,researches:l,researchesExtra:f,researchesAuto:c,toggles:u}=a,{timeSpecial:m,buildingsInfo:g}=o,B=e===0?Date.now()-n.updated:0,v=e===0?B/1e3:e;if(e===0&&(n.updated=Date.now()),B<0)return console.warn("Negative passed time detected.");if(e===0&&(m.lastSave+=B),v>900?(v>F()&&(v=m.maxOffline,console.log(`Offline time was reduced to it's max of ${m.maxOffline/3600} hours.`)),e=v-900,v=900):e!==0&&(e=0),s.current===1){let{discharge:h}=a,{upgradesInfo:p}=o;u.buildings[3]&&c[1]>=3&&k(3,!0),g.producing[3]=.3*t[3].current*p.effect[3]**h.current,i[5]===1&&(g.producing[3]*=p.effect[5]**t[3].true),$(2,v),p.effect[5]=Math.trunc((1.02+.01*l[1])*100)/100,p.effect[3]=4+1*l[3],p.effect[6]=0,g.producing[3]>1&&(p.effect[6]=Math.log(g.producing[3])*12**a.researches[2],i[7]===1&&(p.effect[6]*=h.energyCur)),i[6]===1&&$(3,v),u.buildings[2]&&c[1]>=2&&k(2,!0),g.producing[2]=.4*t[2].current*p.effect[3]**h.current,i[2]===1&&(g.producing[2]*=5),i[5]===1&&(g.producing[2]*=p.effect[5]**t[2].true),$(1,v),u.buildings[1]&&c[1]>=1&&k(1,!0),g.producing[1]=.5*t[1].current*p.effect[3]**h.current,i[1]===1&&(g.producing[1]*=10),i[5]===1&&(g.producing[1]*=p.effect[5]**t[1].true),$(0,v),h.energyMax<h.energyCur&&(h.energyMax=h.energyCur)}else if(s.current===2){let{vaporizationInfo:h,upgradesS2Info:p,researchesExtraS2Info:T}=o,{vaporization:C}=a;if(u.buildings[5]&&c[1]>=5&&k(5,!0),g.producing[5]=2*t[5].current,T.effect[2]=C.clouds**.1,f[2]>=1&&(g.producing[5]*=T.effect[2]),u.buildings[4]&&c[1]>=4&&k(4,!0),g.producing[4]=2*t[4].current,g.producing[5]>1&&(g.producing[4]*=g.producing[5]),p.effect[5]=1+l[5],i[5]===1&&(t[3].current=t[3].true+t[4].current*p.effect[5]),u.buildings[3]&&c[1]>=3&&k(3,!0),g.producing[3]=2*t[3].current,g.producing[4]>1&&(g.producing[3]*=g.producing[4]),p.effect[4]=1+l[4],i[4]===1&&(t[2].current=t[2].true+t[3].current*p.effect[4]),u.buildings[2]&&c[1]>=2&&k(2,!0),g.producing[2]=2*t[2].current*C.clouds,p.effect[2]=.02+l[2]*.02,p.effect[3]=.02+l[3]*.03,i[2]===1&&l[1]>=2?g.producing[2]*=t[0].total**p.effect[2]:i[2]===1&&(g.producing[2]*=t[0].current**p.effect[2]),i[3]===1&&l[1]>=1?g.producing[2]*=t[1].total**p.effect[3]:i[3]===1&&(g.producing[2]*=t[1].current**p.effect[3]),g.producing[3]>1&&(g.producing[2]*=g.producing[3]),T.effect[1]=10**(a.researchesExtra[1]-1),$(1,v),t[0].current<.0028&&t[1].current===0&&(t[0].current=.0028),t[1].current<t[1].true&&(t[1].true=Math.trunc(t[1].current),R(1)),u.buildings[1]&&c[1]>=1&&k(1,!0),g.producing[1]=6e-4*t[1].current,l[0]>=1&&(g.producing[1]*=3**l[0]),i[0]===1&&(g.producing[1]*=1.1**t[1].true),$(0,v),h.get=(f[0]===0?t[1].current:t[1].total)/1e10,h.get>1){let q=h.get**.6+C.clouds,V=q-1e4>0?Math.max(1e4-C.clouds,1):1;h.get=V+(h.get-V)**(q>1e4?.36:.6)}}else if(s.current===3){let{upgradesS3Info:h,researchesS3Info:p,researchesExtraS3Info:T}=o,{accretion:C}=a;u.buildings[4]&&c[1]>=4&&k(4,!0),g.producing[4]=(i[11]===1?1.15:1.1)**t[4].current,u.buildings[3]&&c[1]>=3&&k(3,!0),g.producing[3]=.1*t[3].current,i[4]===1&&f[2]>0&&(g.producing[3]*=2),g.producing[4]>1&&(g.producing[3]*=g.producing[4]),$(2,v),u.buildings[2]&&c[1]>=2&&k(2,!0),g.producing[2]=.1*t[2].current,p.effect[5]=t[0].current**(.025*l[5]),i[3]===1&&(g.producing[2]*=1.02**t[2].true),i[4]===1&&(g.producing[2]*=4),l[2]>=1&&(g.producing[2]*=3**l[2]),l[4]>=1&&(g.producing[2]*=5**l[4]),l[5]>=1&&(g.producing[2]*=p.effect[5]),$(1,v),u.buildings[1]&&c[1]>=1&&k(1,!0),g.producing[1]=5e-20*t[1].current,h.effect[0]=1.01+.01*l[1],h.effect[1]=t[1].current**(.05+.01*f[3]),h.effect[7]=2*1.5**l[6],h.effect[9]=10*3**l[7],T.effect[0]=1.1**f[0],T.effect[1]=(1+.1*f[1])**C.rank,i[0]===1&&(g.producing[1]*=h.effect[0]**t[1].true),i[1]===1&&(g.producing[1]*=h.effect[1]),i[2]===1&&(g.producing[1]*=2),i[5]===1&&(g.producing[1]*=3),i[7]===1&&(g.producing[1]*=h.effect[7]),i[8]===1&&(g.producing[1]*=2),i[9]===1&&(g.producing[1]*=h.effect[9]),l[0]>=1&&(g.producing[1]*=3**l[0]),l[3]>=1&&(g.producing[1]*=2**l[3]),f[0]>=1&&(g.producing[1]*=T.effect[0]),f[1]>=1&&(g.producing[1]*=T.effect[1]),C.rank>=5&&(g.producing[1]**=g.producing[1]<1?1.1:.8),$(0,v),t[0].current>1e30&&C.rank<5&&(t[0].current=1e30)}else if(s.current===4){let{collapse:h,elements:p}=a,{collapseInfo:T,researchesS4Info:C}=o;C.effect[0]=(1.1+.2*l[2])**l[0],C.effect[1]=(1+.01*Math.min(l[1],5)+(l[1]>5?.005*(l[1]-5):0))**(t[1].true+t[2].true+t[3].true+t[4].true),C.effect[1]>1e10&&(C.effect[1]=1e10+(C.effect[1]-1e10)**.7);let q=h.stars[0]+1;p[6]===1&&(q**=1.5);let V=(h.stars[1]+(p[22]===1?h.stars[0]+1:1))**.5;p[12]===1&&h.stars[1]>10&&(V*=Math.log10(h.stars[1]+(p[22]===1?h.stars[0]:0)));let xe=h.stars[2]>=1?(h.stars[2]+1)/Math.log10(h.stars[2]+(p[18]===1?9:99)):1,H=h.mass**(p[21]===1?1.1:1)*C.effect[0]*C.effect[1]*V;p[4]===1&&(H*=1.1),p[19]===1&&(H*=3),p[23]===1&&h.stars[2]>10&&(H*=Math.log10(h.stars[2])),p[24]===1&&(H*=t[0].current**.01),u.buildings[4]&&c[1]>=4&&k(4,!0),g.producing[4]=14e8*t[4].current*H,$(3,v),u.buildings[3]&&c[1]>=3&&k(3,!0),g.producing[3]=2e7*t[3].current*H,$(2,v),u.buildings[2]&&c[1]>=2&&k(2,!0),g.producing[2]=240*t[2].current*q*H,$(1,v),u.buildings[1]&&c[1]>=1&&k(1,!0),g.producing[1]=16*t[1].current*H,p[1]===1&&(g.producing[1]*=2),$(0,v);let J=.004;p[3]===1&&(J+=.001),p[5]===1&&(J+=15e-5*t[1].true),p[10]===1&&(J*=2),p[14]===1&&(J*=1.4),T.newMass=(t[1].true+(p[15]===1?t[2].true+t[3].true+t[4].true:0))*J*xe;for(let K=0;K<=2;K++)T.starCheck[K]=Math.max(t[K+2].true-h.stars[K],0)}e>0&&U(e)},D=()=>{let{stage:e,buildings:s,upgrades:n}=a,{tab:t,subtab:i}=o;if(o.footer&&(e.current===1?(r("quarks").textContent=`Quarks: ${d(s[0].current)}`,a.discharge.energyMax>=9&&(r("energy").textContent=`Energy: ${d(a.discharge.energyCur,0)}`)):e.current===2?(r("water").textContent=`Moles: ${d(s[0].current)}`,t!=="stage"&&(r("drops").textContent=`Drops: ${d(s[1].current)}`),n[1]===1&&(r("clouds").textContent=`Clouds: ${d(a.vaporization.clouds)}`)):e.current===3?r("mass").textContent=`Mass: ${d(s[0].current)}`:e.current===4&&(r("solarMass").textContent=`Mass: ${d(a.collapse.mass)}`,r("elements").textContent=`Elements: ${d(s[0].current)}`)),t==="stage"){let{buildingsInfo:l,lastUpgrade:f}=o,{shop:c}=a.toggles;for(let u=1;u<l.name.length;u++){r(`building${u}Cur`).textContent=d(s[u].current),r(`building${u}Prod`).textContent=d(l.producing[u]);let m=u-1;if(e.current===2&&u!==1?m=1:(e.current===3||e.current===4)&&(m=0),e.current===4&&a.collapse.mass<o.collapseInfo.unlockPriceB[u]){r(`building${u}`).classList.remove("availableBuilding"),r(`building${u}Btn`).textContent=`Unlocked at ${d(o.collapseInfo.unlockPriceB[u])} Mass`,r(`building${u}BuyX`).textContent="Locked";continue}let g,B;if(c.howMany===1||l.cost[u]>s[m].current&&(!c.strict||c.howMany===-1))g=l.cost[u],B=1;else{let v=l.startCost[u]*((l.increase[u]**s[u].true-1)/(l.increase[u]-1)),h=c.strict&&c.howMany!==-1?1:Math.trunc(Math.log((v+s[m].current)*(l.increase[u]-1)/l.startCost[u]+1)/Math.log(l.increase[u]))-s[u].true;B=c.howMany===-1?h:c.strict?c.howMany:Math.min(h,c.howMany),g=l.startCost[u]*((l.increase[u]**(B+s[u].true)-1)/(l.increase[u]-1))-v}g<=s[m].current?(r(`building${u}`).classList.add("availableBuilding"),r(`building${u}Btn`).textContent=`Make for: ${d(g)} ${l.name[m]}`,r(`building${u}BuyX`).textContent=d(B)):(r(`building${u}`).classList.remove("availableBuilding"),r(`building${u}Btn`).textContent=`Need: ${d(g)} ${l.name[m]}`,r(`building${u}BuyX`).textContent=d(B))}if(e.current===1)n[3]===1&&(r("dischargeReset").textContent=`Next goal is ${d(o.dischargeInfo.next,0)} Energy`,r("dischargeEffect").textContent=d(o.upgradesInfo.effect[3],0));else if(e.current===2)n[1]===1&&(r("vaporizationReset").textContent=`Reset for ${d(o.vaporizationInfo.get)} Clouds`);else if(e.current===4){n[0]===1&&(r("collapseReset").textContent=`Collapse to ${d(o.collapseInfo.newMass)} Mass`);for(let u=1;u<=a.researchesExtra[0];u++)r(`starSpecial${u}Cur`).textContent=d(a.collapse.stars[u-1]),r(`starSpecial${u}Get`).textContent=d(o.collapseInfo.starCheck[u-1])}f[0]!==null&&f[2]&&y(f[0],f[1])}else if(t==="research"){let{lastResearch:l}=o;l[0]!==null&&l[2]&&y(l[0],l[1])}else if(t==="settings"){if(i.settingsCurrent==="settings")o.timeSpecial.lastSave>=1e3&&(r("isSaved").textContent=`${d(o.timeSpecial.lastSave,0,"time")} ago`);else if(i.settingsCurrent==="stats"){r("firstPlay").textContent=`${d(Date.now()-a.time.started,0,"time")} ago`,r("stageResetsCount").textContent=d(e.resets,0),r("maxOfflineStat").textContent=`${F()/3600} hours`;for(let l=0;l<a.buildings.length;l++)s[l].trueTotal!==0&&(r(`building${l}StatName`).textContent=o.buildingsInfo.name[l],l!==0&&(r(`building${l}StatTrue`).textContent=d(s[l].true,0)),r(`building${l}StatTotal`).textContent=d(s[l].total),r(`building${l}StatTrueTotal`).textContent=d(s[l].trueTotal));e.current===1&&(r("maxEnergyStat").textContent=d(a.discharge.energyMax,0),r("dischargeStat").textContent=d(a.discharge.current,0))}}},ee=()=>{let{stage:e,buildings:s,upgrades:n,researchesAuto:t}=a,{screenReader:i}=o;if(e.current===1){let{discharge:l}=a;r("energyStat").style.display=l.energyMax>=9?"":"none",r("discharge").style.display=n[3]===1?"":"none",s[1].trueTotal>=11&&(r("building2").style.display=""),s[2].trueTotal>=2&&(r("building3").style.display=""),l.energyMax>=9&&(r("upgrades").style.display=""),l.current>=1&&(r("resetToggles").style.display="");for(let f=5;f<=8;f++)r(`upgrade${f}`).style.display=l.current>=3?"":"none";l.current>=4&&(r("researchTabBtn").style.display=""),n[7]===1&&(r("stage").style.display=""),r("stageReset").textContent=s[3].current>=167e19?"Enter next stage":"You are not ready",i&&(r("invisibleGetResource1").style.display=l.energyMax>0?"":"none"),o.tab==="settings"&&o.subtab.settingsCurrent==="stats"&&(r("energyStats").style.display=l.energyMax>=9?"":"none",r("dischargeStats").style.display=l.current>=1?"":"none"),!a.events[0]&&n[4]===1&&X(0)}else if(e.current===2){let{vaporization:l}=a;r("dropStat").style.display=o.tab!=="stage"?"":"none",r("cloudStat").style.display=n[1]===1?"":"none",r("vaporization").style.display=n[1]===1?"":"none",r("vaporizationToggleReset").style.display=e.true>2||l.clouds>1?"":"none",r("cloudResearch").style.display=l.clouds>1?"":"none",r("upgradeW3").style.display=s[2].trueTotal>=1?"":"none",r("upgradeW4").style.display=s[2].trueTotal>=1?"":"none",r("researchW3").style.display=s[2].trueTotal>=1?"":"none",r("researchW4").style.display=s[2].trueTotal>=1?"":"none",r("upgradeW2").style.display=s[3].trueTotal>=1?"":"none",r("upgradeW5").style.display=s[3].trueTotal>=1?"":"none",r("researchW5").style.display=s[3].trueTotal>=1?"":"none",r("upgradeW6").style.display=s[4].trueTotal>=1?"":"none",r("researchW6").style.display=s[4].trueTotal>=1?"":"none",r("researchClouds3").style.display=s[5].trueTotal>=1?"":"none",s[1].trueTotal>=300&&(r("building2").style.display=""),s[1].trueTotal>=5e6&&(r("building3").style.display=""),s[1].trueTotal>=5e17&&(r("building4").style.display=""),s[1].trueTotal>=5e22&&(r("building5").style.display=""),r("stageReset").textContent=s[1].current>=1194e26?"Enter next stage":"You are not ready",i&&(r("invisibleGetResource1").style.display=n[1]===1?"":"none"),!a.events[0]&&o.vaporizationInfo.get+l.clouds>1e4&&X(1)}else if(e.current===3){let{accretion:l}=a;if(r("buildings").style.display=l.rank!==0?"":"none",r("upgrades").style.display=l.rank>=1?"":"none",r("stageResearch").style.display=l.rank>=1?"":"none",r("upgradeA3").style.display=l.rank>=2?"":"none",r("rankResearch").style.display=l.rank>=2?"":"none",r("researchRank2").style.display=l.rank>=3?"":"none",r("upgradeA5").style.display=l.rank>=3?"":"none",r("researchA5").style.display=l.rank>=3?"":"none",r("upgradeA6").style.display=l.rank>=4||n[4]===1?"":"none",r("researchA6").style.display=l.rank>=4||n[4]===1?"":"none",r("upgradeA7").style.display=l.rank>=4?"":"none",r("upgradeA8").style.display=l.rank>=4?"":"none",r("upgradeA9").style.display=l.rank>=4?"":"none",r("researchA7").style.display=l.rank>=4?"":"none",r("researchRank3").style.display=l.rank>=4?"":"none",r("upgradeA10").style.display=l.rank>=5?"":"none",r("upgradeA11").style.display=l.rank>=5?"":"none",r("upgradeA12").style.display=l.rank>=5?"":"none",r("researchA8").style.display=l.rank>=5?"":"none",r("researchRank4").style.display=l.rank>=5?"":"none",r("upgradeA4").style.display=s[2].trueTotal>=1?"":"none",r("researchA3").style.display=s[2].trueTotal>=1?"":"none",r("researchA4").style.display=s[2].trueTotal>=1?"":"none",r("rankToggleReset").style.display=e.true>3||l.rank>=2?"":"none",r("building2").style.display=n[2]===1?"":"none",r("building3").style.display=n[4]===1?"":"none",r("building4").style.display=n[6]===1?"":"none",r("stageReset").textContent=s[0].current>=247e29?"Enter next stage":"You are not ready",o.tab==="settings"&&o.subtab.settingsCurrent==="stats")for(let f=0;f<o.accretionInfo.rankImage.length;f++)r(`rankStat${f}`).style.display=l.rank>=f?"":"none";!a.events[0]&&s[0].current>=5e29&&X(2)}else if(e.current===4){let{collapse:l,researchesExtra:f}=a;r("collapse").style.display=n[0]===1?"":"none",r("collapseToggleReset").style.display=e.true>4||l.mass>.01235?"":"none",r("starsSpecial").style.display=f[0]>=1?"":"none",r("starSpecial2").style.display=f[0]>=2?"":"none",r("starSpecial3").style.display=f[0]>=3?"":"none",r("starResearch").style.display=s[2].trueTotal>0?"":"none",r("elementsGrid").style.display=n[2]===1?"":"flex";for(let c=6;c<=10;c++)r(`element${c}`).style.display=n[2]===1?"":"none";n[2]===1&&l.mass<10?r("elementsGrid").classList.add("Elements10App"):r("elementsGrid").classList.remove("Elements10App");for(let c=11;c<=26;c++)r(`element${c}`).style.display=l.mass>=10?"":"none";r("building2").style.display=n[1]===1?"":"none",r("building3").style.display=n[2]===1?"":"none",r("building4").style.display=l.mass>=10?"":"none",!a.events[0]&&f[0]>=1&&X(3),i&&(r("invisibleGetResource1").style.display=n[0]===1?"":"none")}for(let l=1;l<b.buildings.length;l++)r(`toggleBuilding${l}`).style.display=t[1]>=l?"":"none",r(`building${l}Stats`).style.display=s[l].trueTotal>0?"":"none",r(`building${l}BuyDiv`).style.display=t[0]>0?"":"none",i&&(r(`invisibleGetBuilding${l}`).style.display=s[l].trueTotal>0?"":"none");r("toggleBuy").style.display=t[0]>0?"":"none"},y=(e,s="upgrades",n=0)=>{var i,l,f;let{stage:t}=a;if(!(n!==0&&n!==t.current))if(s!=="upgrades"&&s!=="elements"){let c="researchesAutoInfo";if(s!=="researchesAuto"&&(c=`${s}${t.current>1?`S${t.current}`:""}Info`),o.lastResearch=[e,s,o[c].effect[e]!==null],s==="researchesAuto"&&e===1){let u=Math.min(a.researchesAuto[1]+1,o.buildingsInfo.name.length-1);o.researchesAutoInfo.effect[1]=a.buildings[u].trueTotal!==0?o.buildingsInfo.name[u]:"(unknown)"}else if(t.current===4&&s==="researchesExtra"&&e===0){let u=Math.min(a.researchesExtra[0]+2,o.buildingsInfo.name.length-1);o.researchesExtraS4Info.effect[0]=a.buildings[u].trueTotal!==0?o.buildingsInfo.name[u]:"(Unknown)"}r("researchText").textContent=o[c].description[e],r("researchEffect").textContent=`${o[c].effectText[e][0]}${d((i=o[c].effect[e])!=null?i:"")}${o[c].effect[e]!==null?`${o[c].effectText[e][1]}`:""}`,r("researchCost").textContent=a[s][e]===o[c].max[e]?"Maxed.":t.current===4&&s==="researches"&&o.collapseInfo.unlockPriceR[e]>a.collapse.mass?`Unlocked at ${d(o.collapseInfo.unlockPriceR[e])} Mass.`:`${d(o[c].cost[e])} ${o.stageInfo.priceName[a.stage.current-1]}.`}else if(s==="elements"){let c="elementsInfo";r("elementText").textContent=o[c].description[e],r("elementEffect").textContent=a[s][e]===1||a.collapse.show>=e?`${o[c].effectText[e][0]}${d((l=o[c].effect[e])!=null?l:"")}${o[c].effect[e]!==null?`${o[c].effectText[e][1]}`:""}`:"Effect is not yet known.",r("elementCost").textContent=a[s][e]===1?"Obtained.":`${d(o[c].cost[e])} ${o.stageInfo.priceName[a.stage.current-1]}.`}else{let c=`${s}${t.current>1?`S${t.current}`:""}Info`;o.lastUpgrade=[e,s,o[c].effect[e]!==null],r("upgradeText").textContent=o[c].description[e],r("upgradeEffect").textContent=`${o[c].effectText[e][0]}${d((f=o[c].effect[e])!=null?f:"")}${o[c].effect[e]!==null?`${o[c].effectText[e][1]}`:""}`,r("upgradeCost").textContent=a[s][e]===1?"Bought.":t.current===4&&o.collapseInfo.unlockPriceU[e]>a.collapse.mass?`Unlocked at ${d(o.collapseInfo.unlockPriceU[e])} Mass.`:`${d(o[c].cost[e])} ${o.stageInfo.priceName[a.stage.current-1]}.`}},A=(e,s="upgrades")=>{let{stage:n}=a,t="researchesAutoInfo";s!=="researchesAuto"&&s!=="elements"?t=`${s}${n.current>1?`S${n.current}`:""}Info`:s==="elements"&&(t="elementsInfo");let i="";s==="researchesAuto"?i="Auto":n.current===2?s==="researches"||s==="upgrades"?i="W":s==="researchesExtra"&&(i="Clouds"):n.current===3?s==="researches"||s==="upgrades"?i="A":s==="researchesExtra"&&(i="Rank"):n.current===4&&(s==="researches"||s==="upgrades"?i="S":s==="researchesExtra"&&(i="Star"));let l;if(s!=="upgrades"&&s!=="elements"?l=r(`research${i}${e+1}Level`):s==="elements"?l=r(`element${e}`):l=r(`upgrade${i}${e+1}`),Object.hasOwn(o[t],"max"))r(`research${i}${e+1}Max`).textContent=String(o[t].max[e]),l.textContent=String(a[s][e]),a[s][e]===o[t].max[e]?l.style.color="var(--green-text-color)":a[s][e]===0?l.style.color="":l.style.color="var(--orchid-text-color)";else{let f="green";s==="elements"?[1,2,3,4,11,12,19,20].includes(e)?f="#780000":[5,6,7,8,9,10,13,14,15,16,17,18].includes(e)?f="#a55900":f="#0000c1":n.current===2?f="darkgreen":n.current===3?f="#0000b1":n.current===4&&(f="#1f1f8f"),l.style.backgroundColor=a[s][e]===1?f:""}},ne=()=>{let{accretion:e}=a,{accretionInfo:s}=o,n=r("rankImage"),t=r("rankName");s.rankCost[4]=a.events[0]?5e29:0,r("rankMessage").textContent=e.rank===0?"Might need more than just water... You can increase rank with Mass.":"You can increase it with Mass. (Return back to Dust, but unlock something new)",r("rankReset").textContent=s.rankCost[e.rank]===0?"Max rank achieved":`Next rank is ${d(s.rankCost[e.rank])} Mass`,n.src=`Used_art/${s.rankImage[e.rank]}.png`,n.alt=s.rankName[e.rank],t.textContent=s.rankName[e.rank],e.rank===0?t.style.color="":e.rank===1?t.style.color="var(--cyan-text-color)":e.rank===5?t.style.color="var(--darkviolet-text-color)":t.style.color="var(--gray-text-color)"},d=(e,s=typeof e=="number"&&e<1e3?e<1?4:2:0,n="number")=>{if(typeof e!="number")return e;switch(n){case"input":case"number":if(!isFinite(e))return"Infinity";if(e>=1e6||e<=.001&&e>0){let t=Math.floor(Math.log10(e)),i=Math.round(e/10**(t-2))/100;return n==="number"?`${i.toLocaleString()}e${t}`:`${i}e${t}`}else if(s>0){let t=Math.round(e*10**s)/10**s;return n==="number"?t.toLocaleString():String(t)}else return n==="number"?Math.round(e).toLocaleString():String(Math.round(e));case"time":return e>=1728e5?`${Math.trunc(e/864e5)} days`:e>=72e5?`${Math.trunc(e/36e5)} hours`:e>=6e5?`${Math.trunc(e/6e4)} minutes`:`${Math.trunc(e/1e3)} seconds`}},te=()=>{let{stage:e}=a,{stageInfo:s,buildingsInfo:n,researchesAutoInfo:t}=o;r("buildings").style.display=e.current!==3?"":"none";for(let u=2;u<b.buildings.length;u++)r(`building${u}`).style.display="none";r("upgradeText").textContent="Hover to see.",r("upgradeEffect").textContent="Hover to see.",r("upgradeCost").textContent="Resource.",r("researchText").textContent="Hover to see.",r("researchEffect").textContent="Hover to see.",r("researchCost").textContent="Resource.",o.lastUpgrade[0]=null,o.lastResearch[0]=null;for(let u=1;u<=4;u++)for(let m of ae(`stage${u}Only`))m.style.display=e.current===u?"":"none";for(let u of ae("stage1Unlock"))u.style.display=e.true>1?"":"none";localStorage.getItem("theme")!==null&&(r("themeArea").style.display="");for(let u=2;u<=s.word.length;u++)r(`switchTheme${u}`).style.display=e.true>=u?"":"none";if(r("researchAuto3").style.display=e.true>=2?"":"none",e.current===1)n.name=["Quarks","Particles","Atoms","Molecules"],n.type=["producing","producing","producing","producing"],n.increase=[0,1.4,1.4,1.4],w.buildingsInfo.startCost=[0,3,24,3],w.researchesAutoInfo.cost[1]=3e3,t.scaling[1]=5e3,o.dischargeInfo.next=Math.round(10**a.discharge.current);else if(e.current===2)n.name=["Moles","Drops","Puddles","Ponds","Lakes","Seas"],n.type=["producing","producing","producing","improves","improves","improves"],n.increase=[0,1.2,1.2,1.2,1.2,1.2],w.buildingsInfo.startCost=[0,.0028,100,1e7,1e18,1e23],w.researchesAutoInfo.cost[1]=1e10,t.scaling[1]=1e3;else if(e.current===3)n.name=["Mass","Cosmic dust","Planetesimals","Protoplanets","Satellites"],n.type=["producing","producing","producing","producing","improves"],n.increase=[0,1.15,1.15,1.15,10],w.buildingsInfo.startCost=[0,1e-19,1e-9,1e21,1e17],w.researchesAutoInfo.cost[1]=1e-7,t.scaling[1]=1e17,ne();else if(e.current===4){n.name=["Elements","Brown dwarfs","Main sequence","Red supergiants","Blue hypergiants"],n.type=["producing","producing","producing","producing","producing"],n.increase=[0,1.4,1.55,1.7,1.85],w.buildingsInfo.startCost=[0,1,1e5,1e16,1e31],w.researchesAutoInfo.cost[1]=1e6,t.scaling[1]=1e11;for(let u=1;u<o.elementsInfo.cost.length;u++)A(u,"elements")}e.current!==4&&I("research","researches");for(let u=1;u<n.name.length;u++)n.startCost[u]=w.buildingsInfo.startCost[u],r(`building${u}Name`).textContent=n.name[u],r(`building${u}Type`).textContent=n.type[u],R(u);let i=`upgrades${e.current>1?`S${e.current}`:""}Info`,l=`researches${e.current>1?`S${e.current}`:""}Info`,f=`researchesExtraS${e.current}Info`;for(let u=0;u<o[i].cost.length;u++)A(u);for(let u=0;u<o[l].cost.length;u++)P(u,"researches");if(e.current!==1)for(let u=0;u<o[f].cost.length;u++)P(u,"researchesExtra");for(let u=0;u<t.cost.length;u++)P(u,"researchesAuto");let c=document.body.style;if(r("stageWord").textContent=s.word[e.current-1],e.current===1?(c.removeProperty("--border-image"),c.removeProperty("--border-stage"),c.removeProperty("--stage-text-color")):(c.setProperty("--border-image",`url(Used_art/Stage${e.current}%20border.png)`),e.current===2?(c.setProperty("--border-stage","#1460a8"),c.setProperty("--stage-text-color","var(--blue-text-color)")):e.current===3?(c.setProperty("--border-stage","#5b5b75"),c.setProperty("--stage-text-color","var(--gray-text-color)")):e.current===4&&(c.setProperty("--border-stage","#e87400"),c.setProperty("--stage-text-color","var(--orange-text-color)"))),o.screenReader){r("invisibleBought").textContent=`Current stage is '${s.word[e.current-1]}'`,r("invisibleGetResource1").textContent=`Get information for ${s.resourceName[e.current-1]}`,e.current===3&&(r("invisibleGetResource1").style.display="none");for(let u=0;u<n.name.length;u++)r(`invisibleGetBuilding${u}`).textContent=`Get information for ${n.name[u]}`}ee()};var ie=(e,s=!1)=>{let{theme:n}=o;s?(n.default=!0,localStorage.removeItem("theme")):(n.default=!1,n.stage=e,localStorage.setItem("theme",String(e))),_()},_=()=>{let{stage:e}=a,{stageInfo:s,theme:n}=o,t=document.body.style;switch(n.default?(n.stage=e.current,r("currentTheme").textContent="Default"):r("currentTheme").textContent=s.word[n.stage-1],t.setProperty("--transition-all","1s"),t.setProperty("--transition-buttons","700ms"),r("upgradeEffect").style.color="",r("upgradeCost").style.color="",r("researchText").style.color="",r("researchEffect").style.color="",r("researchCost").style.color="",r("elementText").style.color="",r("elementEffect").style.color="",r("elementCost").style.color="",t.removeProperty("--background-color"),t.removeProperty("--window-color"),t.removeProperty("--window-border"),t.removeProperty("--footer-color"),t.removeProperty("--button-main-color"),t.removeProperty("--button-main-border"),t.removeProperty("--button-main-hover"),t.removeProperty("--button-tab-border"),t.removeProperty("--button-tab-active"),t.removeProperty("--button-extra-hover"),t.removeProperty("--button-delete-color"),t.removeProperty("--button-delete-hover"),t.removeProperty("--button-text-color"),t.removeProperty("--input-border-color"),t.removeProperty("--input-text-color"),t.removeProperty("--building-can-buy"),t.removeProperty("--main-text-color"),t.removeProperty("--white-text-color"),t.removeProperty("--blue-text-color"),t.removeProperty("--orange-text-color"),t.removeProperty("--gray-text-color"),t.removeProperty("--darkviolet-text-color"),t.removeProperty("--red-text-color"),t.removeProperty("--green-text-color"),n.stage){case 2:r("upgradeEffect").style.color="var(--green-text-color)",r("upgradeCost").style.color="var(--cyan-text-color)",r("researchEffect").style.color="var(--green-text-color)",r("researchCost").style.color="var(--cyan-text-color)",r("elementEffect").style.color="var(--green-text-color)",r("elementCost").style.color="var(--cyan-text-color)",t.setProperty("--background-color","#070026"),t.setProperty("--window-color","#000052"),t.setProperty("--window-border","blue"),t.setProperty("--footer-color","#0000db"),t.setProperty("--button-main-color","blue"),t.setProperty("--button-main-border","#427be1"),t.setProperty("--button-main-hover","#1515cf"),t.setProperty("--button-tab-border","#376ac5"),t.setProperty("--button-tab-active","#990000"),t.setProperty("--button-extra-hover","#2400d7"),t.setProperty("--input-border-color","#4747ff"),t.setProperty("--input-text-color","dodgerblue"),t.setProperty("--main-text-color","dodgerblue"),t.setProperty("--gray-text-color","#9b9b9b"),t.setProperty("--darkviolet-text-color","#a973ff"),t.setProperty("--green-text-color","#82cb3b"),t.setProperty("--red-text-color","#f70000");break;case 3:r("upgradeCost").style.color="var(--green-text-color)",r("researchText").style.color="var(--orange-text-color)",r("researchCost").style.color="var(--green-text-color)",r("elementText").style.color="var(--orange-text-color)",r("elementCost").style.color="var(--green-text-color)",t.setProperty("--background-color","#000804"),t.setProperty("--window-color","#2e1200"),t.setProperty("--window-border","#31373e"),t.setProperty("--footer-color","#221a00"),t.setProperty("--button-main-color","#291344"),t.setProperty("--button-main-border","#404040"),t.setProperty("--button-main-hover","#361f52"),t.setProperty("--button-tab-border","#484848"),t.setProperty("--button-tab-active","#8d4c00"),t.setProperty("--button-extra-hover","#5a2100"),t.setProperty("--button-delete-color","#891313"),t.setProperty("--button-delete-hover","#a10a0a"),t.setProperty("--input-border-color","#8b4a00"),t.setProperty("--input-text-color","#e77e00"),t.setProperty("--main-text-color","#8f8f8f"),t.setProperty("--white-text-color","#dfdfdf"),t.setProperty("--orange-text-color","#f58600"),t.setProperty("--green-text-color","#00db00");break;case 4:r("upgradeEffect").style.color="var(--green-text-color)",r("upgradeCost").style.color="var(--cyan-text-color)",r("researchText").style.color="var(--blue-text-color)",r("researchEffect").style.color="var(--green-text-color)",r("researchCost").style.color="var(--cyan-text-color)",r("elementText").style.color="var(--blue-text-color)",r("elementEffect").style.color="var(--green-text-color)",r("elementCost").style.color="var(--cyan-text-color)",t.setProperty("--background-color","#140e04"),t.setProperty("--window-color","#4e0000"),t.setProperty("--window-border","#894800"),t.setProperty("--footer-color","#4e0505"),t.setProperty("--button-main-color","#6a3700"),t.setProperty("--button-main-border","#9f6700"),t.setProperty("--button-main-hover","#914b00"),t.setProperty("--button-tab-border","#af5d00"),t.setProperty("--button-tab-active","#008297"),t.setProperty("--button-extra-hover","#605100"),t.setProperty("--button-delete-color","#8f0000"),t.setProperty("--button-delete-hover","#ad0000"),t.setProperty("--button-text-color","#d9d900"),t.setProperty("--input-border-color","#008399"),t.setProperty("--input-text-color","#05c3c3"),t.setProperty("--building-can-buy","#007f95"),t.setProperty("--main-text-color","darkorange"),t.setProperty("--white-text-color","#e5e500"),t.setProperty("--blue-text-color","#2694ff"),t.setProperty("--gray-text-color","#8b8b8b"),t.setProperty("--darkviolet-text-color","#9859ff"),t.setProperty("--red-text-color","red");break}setTimeout(()=>{t.removeProperty("--transition-all"),t.removeProperty("--transition-buttons")},1e3)},x=e=>{ke(e)},ke=async e=>await new Promise(s=>{let n=r("blocker");if(n.style.display===""){console.warn("Wasn't able to show another window (alert)"),s();return}r("alertText").textContent=e;let t=r("confirmBtn");n.style.display="";let i=async f=>{(f.key==="Escape"||f.key==="Enter")&&l()},l=()=>{n.style.display="none",document.removeEventListener("keydown",i),t.removeEventListener("click",l),s()};document.addEventListener("keydown",i),t.addEventListener("click",l)}),L=async e=>await new Promise(s=>{let n=r("blocker");if(n.style.display===""){console.warn("Wasn't able to show another window (confirm)"),s(!1);return}r("alertText").textContent=e;let t=r("cancelBtn"),i=r("confirmBtn");n.style.display="",t.style.display="";let l=()=>{u(!0)},f=()=>{u(!1)},c=m=>{m.key==="Escape"?f():m.key==="Enter"&&l()},u=m=>{n.style.display="none",t.style.display="none",document.removeEventListener("keydown",c),i.removeEventListener("click",l),t.removeEventListener("click",f),s(m)};document.addEventListener("keydown",c),i.addEventListener("click",l),t.addEventListener("click",f)}),le=async e=>await new Promise(s=>{let n=r("blocker");if(n.style.display===""){console.warn("Wasn't able to show another window (prompt)"),s(null);return}r("alertText").textContent=e;let t=r("inputArea"),i=r("cancelBtn"),l=r("confirmBtn");t.value="",n.style.display="",i.style.display="",t.style.display="",t.focus();let f=()=>{m(t.value)},c=()=>{m(null)},u=g=>{g.key==="Escape"?c():g.key==="Enter"&&f()},m=g=>{n.style.display="none",i.style.display="none",t.style.display="none",document.removeEventListener("keydown",u),l.removeEventListener("click",f),i.removeEventListener("click",c),s(g)};document.addEventListener("keydown",u),l.addEventListener("click",f),i.addEventListener("click",c)}),re=()=>{let e=r("footer"),s=r("footerColor"),n=r("hideToggle"),t=r("hideText"),i=r("hideArrow");o.footer=!o.footer,n.removeEventListener("click",re),o.footer?(s.style.display="",i.style.transform="",e.style.animation="hide 1s forwards reverse",i.style.animation="rotate 1s forwards reverse",t.textContent="Hide"):(e.style.animation="hide 1s backwards",i.style.animation="rotate 1s backwards",t.textContent="Show",setTimeout(()=>{s.style.display="none",i.style.transform="rotate(180deg)"},1e3)),setTimeout(()=>{e.style.animation="",i.style.animation="",n.addEventListener("click",re)},1e3)},se=(e=!1)=>{var t;let s=Boolean((t=localStorage.getItem("mobile device"))!=null?t:!1),n=r("mobileDeviceToggle");e&&(s=!s),s?(n.textContent="ON",n.style.color="var(--red-text-color)",n.style.borderColor="crimson",localStorage.setItem("mobile device","true"),o.mobileDevice=!0,e&&x("For full support please refresh page. This will add focus event for upgrades, to get description (more can be added if anyone using it)")):(n.textContent="OFF",n.style.color="",n.style.borderColor="",localStorage.removeItem("mobile device"),o.mobileDevice=!1),o.screenReader&&n.setAttribute("aria-label",`Mobile device support is ${n.textContent}`)},Y=(e=!1,s="toggle",n="building")=>{var t;switch(s){case"toggle":{let i=e,l=Boolean((t=localStorage.getItem("screen reader"))!=null?t:!1),f=r("screenReaderToggle");i&&(l=!l),l?(f.textContent="ON",f.style.color="var(--red-text-color)",f.style.borderColor="crimson",f.setAttribute("aria-label","Screen reader support is ON"),localStorage.setItem("screen reader","true"),o.screenReader=!0,n==="reload"&&(a.toggles.shop.strict=!1),i&&x(`For full support please refresh page. You will get: focus event on upgrades to get description (I need feedback on it), special tab to check progress and more.
(For non screen readers it auto sets recommended settings on some stuff)`)):(f.textContent="OFF",f.style.color="",f.style.borderColor="",f.setAttribute("aria-label","Screen reader support is OFF"),localStorage.removeItem("screen reader"),o.screenReader=!1);break}case"button":{let i=e,{stage:l}=a,f=r("invisibleBought");if(n==="building"){let{buildings:c}=a,{buildingsInfo:u}=o,m=i-1;l.current===4&&(m=0),i===0?f.textContent=`You have ${d(c[0].current)} ${u.name[0]}`:f.textContent=`You have ${d(c[i].current)} ${u.name[i]}, they are ${u.type[i]==="producing"?`producing ${d(u.producing[i])} ${u.name[m]} per second`:`improving producion of ${u.name[m]} by ${d(u.producing[i])}`}${a.researchesAuto[1]>=i?`, auto is ${a.toggles.buildings[i]?"on":"off"}`:""}`}else l.current===1?f.textContent=`You have ${d(a.discharge.energyCur)} Energy${a.upgrades[3]===1?`, next discharge goal is ${d(o.dischargeInfo.next)} Energy`:""}`:l.current===2?f.textContent=`You have ${d(a.vaporization.clouds)} Clouds${o.vaporizationInfo.get>1?`, you can get +${d(o.vaporizationInfo.get)} if you reset now`:""}`:l.current===4&&(f.textContent=`You have ${d(a.collapse.mass)} Mass${o.collapseInfo.newMass>=a.collapse.mass?`, you can get +${d(o.collapseInfo.newMass-a.collapse.mass)} if you reset now`:""}${a.researchesExtra[0]>=1?`, also ${d(o.collapseInfo.starCheck[0])} Red giants`:""}${a.researchesExtra[0]>=2?`,  ${d(o.collapseInfo.starCheck[1])} Neutron stars`:""}${a.researchesExtra[0]>=3?` and also ${d(o.collapseInfo.starCheck[2])} Black holes`:""}`);break}}},Z=(e=!1,s=!1)=>{var c;let n=document.body.style,t=r("customFontSize"),i=r("fontSizeToggle"),l=(c=Boolean(localStorage.getItem("enableCustomFontSize")))!=null?c:!1,f=localStorage.getItem("fontSize");e&&(l=!l),l?((f===null||Number(f)<10||Number(f)>32||s)&&(f=String(Math.min(Math.max(Math.trunc(Number(t.value)*10)/10,10),32)),localStorage.setItem("fontSize",f)),n.setProperty("--font-size",`${f}px`),t.value=f,localStorage.setItem("enableCustomFontSize","true"),i.textContent="ON",i.style.color="",i.style.borderColor=""):(n.setProperty("--font-size","1em"),localStorage.removeItem("fontSize"),localStorage.removeItem("enableCustomFontSize"),i.textContent="OFF",i.style.color="var(--red-text-color)",i.style.borderColor="crimson")},X=(e,s=0)=>{if(r("blocker").style.display!=="")switch(a.events[s]=!0,e){case 0:x(`Since you can't get back Energy that you had spend, you will need to Discharge anytime you spend it.
But for the first time, you can keep your Energy`),a.discharge.energyCur+=800;break;case 1:x("Cloud density is too high... Getting more will be harder now");break;case 2:x("Getting more Mass, seems impossible. We need to change our approach, next Rank is going to be Softcapped"),o.accretionInfo.rankCost[4]=5e29,r("rankReset").textContent="Next rank is 5e29 Mass";break;case 3:x(`Any Collapse reset from now on will give extra rewards, but you can only Collapse when can get more or equal Mass.
Each reward effect will be hidden to you for now`)}};var N=e=>{let{stage:s,buildings:n}=a;switch(e){case"discharge":a.discharge.energyCur=0,n[0].current=3;break;case"vaporization":n[0].current=.0028;for(let t=0;t<a.upgrades.length;t++)t!==1&&(a.upgrades[t]=0,A(t));break;case"rank":n[0].current=1e-19;for(let t=0;t<a.upgrades.length;t++)a.upgrades[t]=0,A(t);for(let t=0;t<a.researches.length;t++)a.researches[t]=0,Q(t,"researches"),A(t,"researches");break;case"collapse":n[0].current=1;for(let t=1;t<a.upgrades.length;t++)(t===1||t===2)&&a.collapse.mass>=10||(a.upgrades[t]=0,A(t));for(let t=1;t<a.elements.length;t++)a.elements[t]=0,A(t,"elements");for(let t=0;t<a.researches.length;t++)a.researches[t]=0,Q(t,"researches"),A(t,"researches");break;case"stage":{a.upgrades=[],a.elements=[],a.researches=[],a.researchesExtra=[];let{upgrades:t,researches:i,researchesExtra:l}=a;for(let m=1;m<b.buildings.length;m++)n[m].current=0,n[m].true=0,n[m].total=0,n[m].trueTotal=0;let f=`upgrades${s.current!==1?`S${s.current}`:""}Info`,c=`researches${s.current!==1?`S${s.current}`:""}Info`,u=`researchesExtraS${s.current}Info`;for(let m=0;m<o[f].cost.length;m++)t[m]=0;for(let m=0;m<o[c].cost.length;m++)i[m]=0;if(s.current!==1)for(let m=0;m<o[u].cost.length;m++)l[m]=0;switch(s.current){case 1:n[0].current=3,a.discharge.energyCur=0,a.discharge.energyMax=0,a.discharge.current=0;break;case 2:n[0].current=.0028,a.vaporization.clouds=1;break;case 3:a.accretion.rank===0?n[0].current=597e25:(n[0].current=1e-19,a.accretion.rank=1);break;case 4:n[0].current=1,a.collapse.mass=.01235,a.collapse.stars=[0,0,0],a.collapse.show=-1;for(let m=0;m<o.elementsInfo.cost.length;m++)a.elements[m]=0}n[0].total=s.current!==3?n[0].current:1e-19,n[0].trueTotal=n[0].total,a.events=s.true>s.current?[!0]:[!1],te(),_();break}}if(e!=="stage"){n[0].total=n[0].current;for(let t=1;t<b.buildings.length;t++)n[t].current=0,n[t].true=0,n[t].total=0,R(t)}U(),D()};var a={version:"v0.0.6",stage:{true:1,current:1,resets:0},discharge:{energyCur:0,energyMax:0,current:0},vaporization:{clouds:1},accretion:{rank:0},collapse:{mass:.01235,stars:[0,0,0],show:-1},intervals:{main:100,numbers:100,visual:1,autoSave:180},time:{updated:Date.now(),started:Date.now()},buildings:[{current:3,total:3,trueTotal:3},{current:0,true:0,total:0,trueTotal:0},{current:0,true:0,total:0,trueTotal:0},{current:0,true:0,total:0,trueTotal:0},{current:0,true:0,total:0,trueTotal:0},{current:0,true:0,total:0,trueTotal:0}],upgrades:[0,0,0,0,0,0,0,0],elements:[],researches:[0,0,0,0,0],researchesExtra:[0,0,0],researchesAuto:[0,0,0],toggles:{normal:[],buildings:[],auto:[],shop:{howMany:1,input:10,strict:!0}},events:[!1]},o={tab:"stage",subtab:{settingsCurrent:"settings",researchCurrent:"researches"},tabList:{tabs:["stage","research","settings","special"],settingsSubtabs:["settings","stats"],researchSubtabs:["researches","elements"]},footer:!0,mobileDevice:!1,screenReader:!1,versionInfo:{changed:!1,log:"Change log:"},timeSpecial:{lastSave:0,maxOffline:7200},stageInfo:{word:["Microworld","Submerged","Accretion","Interstellar"],priceName:["Energy","Drops","Mass","Elements"],resourceName:["Energy","Clouds","Rank","Stars"]},theme:{stage:1,default:!0},dischargeInfo:{energyType:[0,1,5,20],next:1},vaporizationInfo:{get:0},accretionInfo:{rankCost:[597e25,1e-7,1e10,1e24,0,0],rankName:["Ocean world","Cosmic dust","Meteoroid","Asteroid","Planet","Jovian planet"],rankImage:["Ocean%20world","Dust","Meteoroids","Asteroid","Planet","Giant"]},collapseInfo:{unlockPriceB:[0,.01235,.23,10,40],unlockPriceU:[.01235,.076,1.3],unlockPriceR:[.18,.3,.8],newMass:0,starCheck:[0,0,0]},intervalsId:{main:0,numbers:0,visual:0,autoSave:0},buildingsInfo:{name:["Quarks","Particles","Atoms","Molecules"],type:["producing","producing","producing","producing"],cost:[0,3,24,3],startCost:[0,3,24,3],increase:[1.4,1.4,1.4,1.4],producing:[0,0,0,0,0,0]},upgradesInfo:{description:["Bigger electrons. Particles cost decreased.","Stronger protons. Particles produce more.","More neutrons. Increased gain of Particles.","Superposition. Unlocks new reset tier.","Protium. Basic.","Deuterium. Heavy.","Tritium. Radioactive.","Nuclear fusion. More Energy."],effectText:[["Particle cost is "," times cheaper."],["Particles produce "," times more Quarks."],["Atoms produce "," times more Particles."],["Ability to reset at any time, and if you had enough Energy, production for all buildings will be boosted by "," times."],["Cost scaling is decreased by ","."],["Buildings (only self-made one's) boost themselves by "," times."],["Molecules produce Molecules. At a reduced rate. ("," per second)"],["Unspent Energy boost Molecules production of themselves 1 to 1."]],effect:[10,10,5,4,.2,1.01,0,null],cost:[9,12,36,300,800,4e3,13e3,36e3]},researchesInfo:{description:["Effect of 'Protium' upgrade is stronger.","Effect of 'Deuterium' upgrade is bigger.","Effect of 'Tritium' upgrade is better.","Discharge bonus improved.","Gain more Energy from buying a building."],effectText:[["Cost scaling is "," smaller for each level."],["Each self-made building, boost each other by additional ","."],["Molecules now produce themselves "," times quicker."],["Discharge is now gives extra +"," bonus per reached goal."],["A single building now gives "," times more Energy."]],effect:[.01,.01,12,1,3],cost:[2e3,6e3,18e3,1e4,42e3],scaling:[250,1e3,2e3,0,88e3],max:[9,3,9,1,2]},upgradesS2Info:{description:["A single Mole is a 6.022e23 Molecules.","Vaporization. Unlock new reset tier.","Surface tension. Allows for bigger Puddles.","Surface stress. Even bigger Puddles.","Stream. Spreads water around.","River. Spreads even more water."],effectText:[[`Drops produce Moles, based on how many Drops you have made.
(You lose self-made one's automatically, if they are less than current amount)`],["Gain ability to convert Drops into Clouds. (Puddles get boost equal to Cloud amount)"],["Puddles get boost based on Moles. (Equal to Moles ^ ",")"],["Puddles get boost based on Drops. (Equal to Drops ^ ",")"],[`Ponds do not produce Puddles, instead they give direct bonus to them.
This upgrade will give extra Puddles for every Pond you have. (`," extra Puddles per Pond)"],["Lakes now give extra Ponds. ("," extra Ponds per Lake)"]],effect:[null,null,.02,.02,1,1],cost:[1e4,1e10,1e3,1e4,2e9,5e20]},researchesS2Info:{description:["Better Mole production.","All of it, is still around.","Stronger surface tension.","Stronger surface stress.","More streams.","Distributary channel."],effectText:[["Drops produce "," times more Moles."],["Bonus to buildings is now based on total produced, rather than on hands. Level 1 for Drops, level 2 for Moles."],["Surface tension upgrade is now +"," stronger."],["Surface stress upgrade is now +"," stronger."],["With more streams, you can have even more extra Puddles. (+"," extra Puddles per Pond)"],["Rivers can split now, that allows even more Ponds per Lake. (+"," per)"]],effect:[3,null,.02,.03,1,1],cost:[20,1e12,1e5,1e6,1e14,1e22],scaling:[1.2,1e3,1e3,1e4,1e3,100],max:[9,2,3,3,2,2]},researchesExtraS2Info:{description:["Natural vaporization.","Rain Clouds.","Storm Clouds."],effectText:[["Clouds will now use total produced Drops instead, when formed."],["Some Clouds will start pouring Drops themselves. ("," per second)"],["Seas get boost based on amount of Clouds. (Equal to ",")"]],effect:[null,0,0],cost:[1e16,1e13,1e26],scaling:[0,100,0],max:[1,4,1]},upgradesS3Info:{description:["Brownian motion.","Gas. New substance for Accretion.","Micrometeoroid. Unlock a new building.","Streaming instability.","Gravitational field. Unlock a new building.","Rubble pile.","Satellite system.","Magma ocean.","Atmosphere.","Pebble accretion.","Tidal force.","Ring system."],effectText:[["Through random collisions every self-made Dust speeds up Accretion speed. (By ",")"],["Accretion speed is now quicker based on current Dust amount. ("," boost)"],["Just a small meteoroid, but it will be a good base for what to come. (Also ","x boost to Dust)"],["Small bodies spontaneously concentrate into clumps. (Self-made Planetesimals boost each other by ",")"],["Bodies are now massive enough to affect each other with gravity. (","x boost to Planetesimals)"],["Shattered pieces fall back together. Mass producion is now even bigger. (By ","x)"],["Unlocks yet another building."],["Core melted, Accretion speed increased. (Mass production increased by ",")"],["Accretion speed increased again (because of drag and escape velocity), by ","."],["Accretion speed greatly increased by ","."],["Satellites scaling cost is now "," times smaller."],["Satellites effect is increased."]],effect:[1.01,0,2,1.1,4,3,null,2,2,10,2,null],cost:[1e-16,1e-13,1e-13,1,1e14,1e17,1e22,1e11,1e23,1e9,1e26,1e29]},researchesS3Info:{description:["More massive bodies.","Adhesion.","Space weathering.","Inelastic collisions.","Contact binary.","Gravity.","Planetary differentiation.","Aerodynamic drag."],effectText:[["Dust production is increased by ","."],["Dust particles cling to each other. (+"," to 'Brownian motion')"],["Planetesimals produce more Dust. ("," times more)"],["Slow encounter velocities will result in a more efficient growth, so this research will make bodies lose more energy with each deflection. Mass production increased by ","."],["Some Planetesimals instead of shattering forming contact binary or even trinary. Planetesimals production boosted by ","x."],[`Planetesimals attract other bodies with own gravity. Planetesimals get boost to production based on unspent Mass.
(Total boost: `,")"],["'Magma Ocean' upgrade is stronger now. (","x times)"],["Accretion speed for 'Pebble accretion' increased again, by ","."]],effect:[3,.01,3,2,5,0,1.5,3],cost:[1e-14,1e-15,1e-5,1e5,1e10,1e15,1e13,1e12],scaling:[11,111,22,10,100,10,1e5,1e3],max:[7,3,9,4,2,5,3,3]},researchesExtraS3Info:{description:["Rank, can now boost Dust production.","Efficient growth.","Weight.","Viscosity."],effectText:[["Dust production is increased by another ","."],["Accretion speed is even quicker. Multiplied by current rank. (Total boost to Dust: ",")"],["'Gravitational field' upgrade will boost Protoplanets now as well. (Only half of effect)"],["'Gas' upgrade is now stronger."]],effect:[0,0,null,null],cost:[1e-18,1e-16,1e26,1e-12],scaling:[10,100,0,100],max:[12,5,1,20]},upgradesS4Info:{description:["Gravitational collapse.","Proton-proton chain.","Carbon\u2013Nitrogen\u2013Oxygen cycle."],effectText:[["As fuel runs out, each star will boost production in its own special way."],["Fuse with Protium instead of Deuterium. Unlocks a new building and something else."],["CNO cycle is now a better source of Helium and Energy. Unlocks a new building and more of something else."]],effect:[null,null,null],cost:[100,1e3,1e9]},elementsInfo:{description:["[0] Placeholder.","[1] Hydrogen.","[2] Helium.","[3] Lithium.","[4] Beryllium.","[5] Boron.","[6] Carbon.","[7] Nitrogen.","[8] Oxygen.","[9] Fluorine.","[10] Neon.","[11] Sodium.","[12] Magnesium.","[13] Aluminium.","[14] Silicon.","[15] Phosphorus.","[16] Sulfur.","[17] Chlorine.","[18] Argon.","[19] Potassium.","[20] Calcium.","[21] Scandium.","[22] Titanium.","[23] Vanadium.","[24] Chromium.","[25] Manganese.","[26] Iron."],effectText:[["Placeholder"],["Most basic element, increases Brown dwarf production by ","."],["Fusion reaction by product, makes everything scale "," less."],["First metal, Mass per Brown dwarf lightly increased."],["Brittle earth metal, so is brittle increase to production. (","x to all Stars)"],["A new color, and a new boost to Mass gain that is based on current Dwarf Stars."],["Base for organics, boost to Main-sequence stars through Red giants is now increases to power of ","."],["Most abundant uncombined Element in atmospehere of some Planets, also gives you "," extra levels to 'Star system'."],["An oxidizing agent, that will make everything scale even slower. ("," less)"],["Highly toxic and reactive, +"," to max level of 'Planetary system'."],["A noble ","x boost to Mass gain."],["Through leaching, you can get "," extra level of 'Protoplanetary disk'."],["Stars are inside you, as well Neutrons stars boost to all Stars is now increased to the decimal logarithm."],["Has a great affinity towards oxygen and to decrease cost of all Stars by ","."],["Number is 14, group is 14, also 1414\xB0C and so is Mass gain increased by ","."],["One of the fundamentals of life and to make all of your Stars boost Mass."],["From hot area, to give you +",` max level to 'Star system'.
Research softcapped past 1e10.`],["Extremely reactive to extend max level of 'Planetary system', by another "," levels."],["Less noble boost, but bonus to Mass gain from Black holes scales a little better."],["Don't forget about it and get a ","x boost to all Stars."],["Make yourself stronger with ",` extra level of 'Star system'.
Effect is weaker, after 5 levels.`],["A new color and a rare bonus of ^"," to Mass effect."],["New alloy allowing Red giants to be added into effective amount of Neutron stars."],["Catalyst for your production of Elements. Black holes boost all Stars to the decimal logarithm."],["No corrosion, only ^"," boost to all Stars based on unspent Elements."],["Brittle element, but not the bonus - "," more level in 'Star system'."],["Work in progress, sorry, that is the end for now..."]],effect:[null,2,.1,null,1.1,null,1.5,2,.05,12,2,1,null,1e3,1.4,null,1,27,null,3,1,1.1,null,null,.01,1,null],cost:[1e308,1e3,4e3,2e4,1e5,1e8,1e10,4e11,2e13,1e14,1e16,1e20,1e24,1e25,14e26,1e30,1e31,5e31,5e33,1e35,1e36,1e38,2e39,3e41,4e42,1e45,1e50]},researchesS4Info:{description:["Planetary system.","Star system.","Protoplanetary disk."],effectText:[["From Planetesimals to Planets, you get ","x boost to all Stars."],["Each Star boost another Star. (Total to each Star is ","x)."],["Improve effect of 'Planetary system', as well increases its max level by +","."]],effect:[1.1,1,3],cost:[1e3,5e4,1e8],scaling:[10,200,1e12],max:[3,2,1]},researchesExtraS4Info:{description:["At the end of Star life."],effectText:[[""," building now gives something new, upon collapse reset."]],effect:["Main sequence"],cost:[1e6],scaling:[1e12],max:[3]},researchesAutoInfo:{description:["Buy toggles.","Automatization for buying buildings.","Increased max offline time."],effectText:[["Unlock abbility to buy multiple buildings at same time."],["Will automatically buy "," for you."],["Research this to make max offline timer +"," hour longer."]],effect:[null,"Particles",2],cost:[300,3e3,1e9],scaling:[0,5e3,0],max:[1,3,1]},lastUpgrade:[null,"upgrades",!1],lastResearch:[null,"researches",!1]},ce=(e,s)=>{let n=[];for(let t=0;t<e;t++)s==="toggle"?n.push(!0):s==="toggleAuto"&&n.push(!1);return n},we=document.getElementsByClassName("toggle").length,Ie=document.getElementsByClassName("toggleBuilding").length,Ce=document.getElementsByClassName("toggleAuto").length;Object.assign(a.toggles,{normal:ce(we,"toggle")});Object.assign(a.toggles,{buildings:ce(Ie+1,"toggleAuto")});Object.assign(a.toggles,{auto:ce(Ce,"toggleAuto")});var b=structuredClone(a),w=structuredClone(o),oe=e=>e==="p"?structuredClone(b):structuredClone(w),be=()=>{let{stage:e}=a,s=`upgrades${e.current>1?`S${e.current}`:""}Info`,n=`researches${e.current>1?`S${e.current}`:""}Info`,t=`researchesExtraS${e.current}Info`;for(let i=0;i<o[s].cost.length;i++)a.upgrades[i]>1&&(a.upgrades[i]=1,console.error(`Upgrade (${i+1}) had an illegal value`));if(e.current===4)for(let i=1;i<o.elementsInfo.cost.length;i++)a.elements[i]>1&&(a.elements[i]=1,console.error(`Element (${i}) had an illegal value`));for(let i=0;i<o[n].cost.length;i++)a.researches[i]>o[n].max[i]&&(a.researches[i]=o[n].max[i],console.error(`Research (${i+1}) had level above maxium`));if(e.current!==1)for(let i=0;i<o[t].cost.length;i++)a.researchesExtra[i]>o[t].max[i]&&(a.researchesExtra[i]=o[t].max[i],console.error(`Extra research (${i+1}) had level above maxium`));for(let i=0;i<o.researchesAutoInfo.cost.length;i++)a.researchesAuto[i]>o.researchesAutoInfo.max[i]&&(a.researchesAuto[i]=o.researchesAutoInfo.max[i],console.error(`Research (${i+1}) for automatization had level above maxium`))},ue=e=>{let s=oe("p");if(Object.hasOwn(e,"player")&&(e=e.player),!Object.hasOwn(e,"discharge"))throw new ReferenceError("This save file is missing important information and is most likely not from this game");for(let c in b)Object.hasOwn(e,c)||(c==="version"?e.version="0.0.0":e[c]=s[c]);for(let c in e)Object.hasOwn(b,c)||delete e[c];let n=`upgrades${e.stage.current>1?`S${e.stage.current}`:""}Info`,t=`researches${e.stage.current>1?`S${e.stage.current}`:""}Info`,i=`researchesExtraS${e.stage.current}Info`;if(b.buildings.length>e.buildings.length)for(let c=e.buildings.length;c<b.buildings.length;c++)e.buildings[c]=s.buildings[c];if(o[n].cost.length>e.upgrades.length)for(let c=e.upgrades.length;c<o[n].cost.length;c++)e.upgrades[c]=0;if(o[t].cost.length>e.researches.length)for(let c=e.researches.length;c<o[t].cost.length;c++)e.researches[c]=0;if(e.stage.current!==1&&o[i].cost.length>e.researchesExtra.length)for(let c=e.researchesExtra.length;c<o[i].cost.length;c++)e.researchesExtra[c]=0;if(b.researchesAuto.length>e.researchesAuto.length)for(let c=e.researchesAuto.length;c<b.researchesAuto.length;c++)e.researchesAuto[c]=0;if(e.stage.current===4&&o.elementsInfo.cost.length>e.elements.length)for(let c=e.elements.length;c<o.elementsInfo.cost.length;c++)e.elements[c]=0;if(Object.hasOwn(e.toggles,"normal")){if(b.toggles.normal.length>e.toggles.normal.length)for(let c=e.toggles.normal.length;c<b.toggles.normal.length;c++)e.toggles.normal[c]=s.toggles.normal[c];if(b.toggles.buildings.length>e.toggles.buildings.length)for(let c=e.toggles.buildings.length;c<b.toggles.buildings.length;c++)e.toggles.buildings[c]=s.toggles.buildings[c];if(b.toggles.auto.length>e.toggles.auto.length)for(let c=e.toggles.auto.length;c<b.toggles.auto.length;c++)e.toggles.auto[c]=s.toggles.auto[c]}else e.toggles=s.toggles;Object.assign(a,e);let{versionInfo:l}=o,f=a.version;l.changed=!1,l.log="Change log:",a.version==="0.0.0"&&(a.version="v0.0.1",l.log+=`
${a.version} - Stage 2 has properly came out; Buildings and Energy has been reset to prevent save file corruption, sorry`,a.stage.current===2?(N("stage"),a.researchesAuto=[1,0,0]):a.stage.current===1&&(N("discharge"),a.discharge.energyMax=0)),a.version==="v0.0.1"&&(a.version="v0.0.2",l.log+=`
${a.version} - Added dynamic descriptions for upgrades, stats subtab, early Mobile device support`,a.stage.resets=a.stage.current===2?1:0),a.version==="v0.0.2"&&(a.version="v0.0.3",l.log+=`
${a.version} - Stage 3 is out, stage 2 extended. Dynamic update for researches, new stats, full reset of toggles (sorry). Also max offline time is now 2 times bigger...`),a.version==="v0.0.3"&&(a.version="v0.0.4",l.log+=`
${a.version} - All stage's are now quicker (because too many people complain, but there isn't much of a content currently...), save file size decreased, small visual changes`),a.version==="v0.0.4"&&(a.version="v0.0.5",l.log+=`
${a.version} - First part of Stage 4 is out, also small visual changes. Screen readers support updated (I forgot about it since stage 2...). Also testing new formula for buying buildings and other minor stuff`),a.version==="v0.0.5"&&(a.version="v0.0.6",l.log+=`
${a.version} - Minor bug fixes, also transition for theme change fixed. Minor QoL, hotkeys, event system reworked`,a.events=a.stage.current===1&&a.discharge.current>4?[!0]:[!1],a.collapse.show=-1),f!==a.version&&(l.changed=!0)};var ve=e=>{if(r("blocker").style.display==="")return;let s=a.toggles.normal[6]?e.key.toLowerCase():e.code.toLowerCase();if(!isNaN(Number(s.replace("digit","")))){let n=Number(s.replace("digit",""));if(n===0||n>=o.buildingsInfo.name.length)return;k(n)}if(!e.repeat){if(s==="arrowleft"||s==="arrowright"){let{tabs:n}=o.tabList,t=n.indexOf(o.tab);if(t===-1)return;if(s==="arrowleft"){do t===0?t=n.length-1:t--;while(!z(n[t]));I(n[t])}else{do t===n.length-1?t=0:t++;while(!z(n[t]));I(n[t])}}else if(s==="arrowdown"||s==="arrowup"){if(!Object.hasOwn(o.subtab,o.tab+"Current"))return;let n=o.tabList[o.tab+"Subtabs"],t=n.indexOf(o.subtab[o.tab+"Current"]);if(t===-1)return;if(s==="arrowdown"){do t===0?t=n.length-1:t--;while(!z(o.tab,n[t]));I(o.tab,n[t])}else{do t===n.length-1?t=0:t++;while(!z(o.tab,n[t]));I(o.tab,n[t])}}}};var r=e=>{let s=document.getElementById(e);if(s!==null)return s;throw x(`ID of HTML element (${e}), failed to load, game will not work properly, please refresh. If this happens more than once, then please report it`),new ReferenceError(`ID "${e}" not found.`)},ae=e=>Array.from(document.getElementsByClassName(e)),fe=async(e=!1)=>{if(e){console.time("Game loaded in");let s=localStorage.getItem("save"),n=localStorage.getItem("theme");if(s!==null){let t=JSON.parse(atob(s));if(ue(t),a.toggles.normal[0]){let i=Date.now()-a.time.updated;x(`Welcome back, you were away for ${d(i,0,"time")}.${i>F()*1e3?` (Max offline time is ${o.timeSpecial.maxOffline/3600} hours)`:""}${o.versionInfo.changed?`
Game has been updated to ${a.version}, ${o.versionInfo.log}`:`
Current version is ${a.version}`}`)}}else x(`Welcome to 'Fundamental'.
This is a test-project made by awWhy. Should be supported by modern browsers, phones and screen readers (need to turn support ON in settings).
Was inspired by 'Synergism', 'Antimatter Dimensions' and others.
Current version is ${a.version}`);n!==null&&(o.theme.default=!1,o.theme.stage=Number(n)),se(),Y(!1,"toggle","reload"),Z()}te(),be(),e&&(r("body").style.display="",r("loading").style.display="none",console.timeEnd("Game loaded in"));for(let s=0;s<b.toggles.normal.length;s++)G(s,"normal");for(let s=1;s<b.toggles.buildings.length;s++)G(s,"buildings");for(let s=0;s<b.toggles.auto.length;s++)G(s,"auto");if(W(),_(),e&&!a.toggles.normal[0]){let s=Date.now()-a.time.updated;await L(`Welcome back, you were away for ${d(s,0,"time")}${s>F()*1e3?` (max offline time is ${o.timeSpecial.maxOffline/3600} hours)`:""}. Game was set to have offline time disabled. Press confirm to NOT to gain offline time.${o.versionInfo.changed?`
Also game has been updated to ${a.version}, ${o.versionInfo.log}`:`
Current version is ${a.version}`}`)&&(o.timeSpecial.lastSave+=s,a.time.updated=Date.now())}O(!1,"all"),U()};fe(!0);var{mobileDevice:M,screenReader:E}=o;document.addEventListener("keydown",e=>ve(e));for(let e=0;e<b.toggles.normal.length;e++)r(`toggle${e}`).addEventListener("click",()=>G(e,"normal",!0));for(let e=1;e<b.toggles.buildings.length;e++)r(`toggleBuilding${e}`).addEventListener("click",()=>G(e,"buildings",!0));for(let e=0;e<b.toggles.auto.length;e++)r(`toggleAuto${e}`).addEventListener("click",()=>G(e,"auto",!0));for(let e=1;e<b.buildings.length;e++)r(`building${e}Btn`).addEventListener("click",()=>k(e));for(let e=0;e<o.upgradesInfo.cost.length;e++)r(`upgrade${e+1}`).addEventListener("mouseover",()=>y(e,"upgrades",1)),r(`upgrade${e+1}`).addEventListener("click",()=>S(e,"upgrades",1)),(E||M)&&r(`upgrade${e+1}`).addEventListener("focus",()=>y(e,"upgrades",1));for(let e=0;e<o.upgradesS2Info.cost.length;e++)r(`upgradeW${e+1}`).addEventListener("mouseover",()=>y(e,"upgrades",2)),r(`upgradeW${e+1}`).addEventListener("click",()=>S(e,"upgrades",2)),(E||M)&&r(`upgradeW${e+1}`).addEventListener("focus",()=>y(e,"upgrades",2));for(let e=0;e<o.upgradesS3Info.cost.length;e++)r(`upgradeA${e+1}`).addEventListener("mouseover",()=>y(e,"upgrades",3)),r(`upgradeA${e+1}`).addEventListener("click",()=>S(e,"upgrades",3)),(E||M)&&r(`upgradeA${e+1}`).addEventListener("focus",()=>y(e,"upgrades",3));for(let e=0;e<o.upgradesS4Info.cost.length;e++)r(`upgradeS${e+1}`).addEventListener("mouseover",()=>y(e,"upgrades",4)),r(`upgradeS${e+1}`).addEventListener("click",()=>S(e,"upgrades",4)),(E||M)&&r(`upgradeS${e+1}`).addEventListener("focus",()=>y(e,"upgrades",4));r("dischargeReset").addEventListener("click",async()=>await me());r("vaporizationReset").addEventListener("click",async()=>await pe());r("rankReset").addEventListener("click",async()=>await he());r("stageReset").addEventListener("click",async()=>await de());r("collapseReset").addEventListener("click",async()=>await ye());r("buy1x").addEventListener("click",()=>W("1"));r("buyAny").addEventListener("click",()=>W("any"));r("buyAnyInput").addEventListener("blur",()=>W("any"));r("buyMax").addEventListener("click",()=>W("max"));r("buyStrict").addEventListener("click",()=>W("strict"));for(let e=0;e<o.researchesInfo.cost.length;e++)r(`research${e+1}Image`).addEventListener("mouseover",()=>y(e,"researches",1)),r(`research${e+1}Image`).addEventListener("click",()=>S(e,"researches",1)),(E||M)&&r(`research${e+1}Image`).addEventListener("focus",()=>y(e,"researches",1));for(let e=0;e<o.researchesS2Info.cost.length;e++)r(`researchW${e+1}Image`).addEventListener("mouseover",()=>y(e,"researches",2)),r(`researchW${e+1}Image`).addEventListener("click",()=>S(e,"researches",2)),(E||M)&&r(`researchW${e+1}Image`).addEventListener("focus",()=>y(e,"researches",2));for(let e=0;e<o.researchesExtraS2Info.cost.length;e++)r(`researchClouds${e+1}Image`).addEventListener("mouseover",()=>y(e,"researchesExtra",2)),r(`researchClouds${e+1}Image`).addEventListener("click",()=>S(e,"researchesExtra",2)),(E||M)&&r(`researchClouds${e+1}Image`).addEventListener("focus",()=>y(e,"researchesExtra",2));for(let e=0;e<o.researchesS3Info.cost.length;e++)r(`researchA${e+1}Image`).addEventListener("mouseover",()=>y(e,"researches",3)),r(`researchA${e+1}Image`).addEventListener("click",()=>S(e,"researches",3)),(E||M)&&r(`researchA${e+1}Image`).addEventListener("focus",()=>y(e,"researches",3));for(let e=0;e<o.researchesExtraS3Info.cost.length;e++)r(`researchRank${e+1}Image`).addEventListener("mouseover",()=>y(e,"researchesExtra",3)),r(`researchRank${e+1}Image`).addEventListener("click",()=>S(e,"researchesExtra",3)),(E||M)&&r(`researchRank${e+1}Image`).addEventListener("focus",()=>y(e,"researchesExtra",3));for(let e=0;e<o.researchesS4Info.cost.length;e++)r(`researchS${e+1}Image`).addEventListener("mouseover",()=>y(e,"researches",4)),r(`researchS${e+1}Image`).addEventListener("click",()=>S(e,"researches",4)),(E||M)&&r(`researchS${e+1}Image`).addEventListener("focus",()=>y(e,"researches",4));for(let e=0;e<o.researchesExtraS4Info.cost.length;e++)r(`researchStar${e+1}Image`).addEventListener("mouseover",()=>y(e,"researchesExtra",4)),r(`researchStar${e+1}Image`).addEventListener("click",()=>S(e,"researchesExtra",4)),(E||M)&&r(`researchStar${e+1}Image`).addEventListener("focus",()=>y(e,"researchesExtra",4));for(let e=0;e<o.researchesAutoInfo.cost.length;e++)r(`researchAuto${e+1}Image`).addEventListener("mouseover",()=>y(e,"researchesAuto")),r(`researchAuto${e+1}Image`).addEventListener("click",()=>S(e,"researchesAuto")),(E||M)&&r(`researchAuto${e+1}Image`).addEventListener("focus",()=>y(e,"researchesAuto"));for(let e=1;e<o.elementsInfo.cost.length;e++)r(`element${e}`).addEventListener("mouseover",()=>y(e,"elements",4)),r(`element${e}`).addEventListener("click",()=>S(e,"elements",4)),(E||M)&&r(`element${e}`).addEventListener("focus",()=>y(e,"elements",4));r("save").addEventListener("click",async()=>await j("save"));r("file").addEventListener("change",async()=>await j("load"));r("export").addEventListener("click",async()=>await j("export"));r("delete").addEventListener("click",async()=>await j("delete"));r("switchTheme0").addEventListener("click",()=>ie(0,!0));for(let e=1;e<=o.stageInfo.word.length;e++)r(`switchTheme${e}`).addEventListener("click",()=>ie(e));r("mainInterval").addEventListener("blur",()=>O(!1,"main"));r("numbersInterval").addEventListener("blur",()=>O(!1,"numbers"));r("visualInterval").addEventListener("blur",()=>O(!1,"visual"));r("autoSaveInterval").addEventListener("blur",()=>O(!1,"autoSave"));r("pauseGame").addEventListener("click",async()=>await $e());r("fontSizeToggle").addEventListener("click",()=>Z(!0));r("customFontSize").addEventListener("blur",()=>Z(!1,!0));r("mobileDeviceToggle").addEventListener("click",()=>se(!0));r("screenReaderToggle").addEventListener("click",()=>Y(!0));if(E){for(let e=0;e<b.buildings.length;e++)r(`invisibleGetBuilding${e}`).addEventListener("click",()=>Y(e,"button"));r("invisibleGetResource1").addEventListener("click",()=>Y(0,"button","resource")),r("specialTabBtn").addEventListener("click",()=>I("special")),r("specialTabBtn").style.display=""}r("hideToggle").addEventListener("click",re);r("stageTabBtn").addEventListener("click",()=>I("stage"));r("researchTabBtn").addEventListener("click",()=>I("research"));r("settingsTabBtn").addEventListener("click",()=>I("settings"));r("researchSubtabBtnresearches").addEventListener("click",()=>I("research","researches"));r("researchSubtabBtnelements").addEventListener("click",()=>I("research","elements"));r("settingsSubtabBtnsettings").addEventListener("click",()=>I("settings","settings"));r("settingsSubtabBtnstats").addEventListener("click",()=>I("settings","stats"));function O(e=!1,s=""){let{intervals:n}=a,{intervalsId:t}=o;if(s!==""){let i=r("mainInterval"),l=r("numbersInterval"),f=r("visualInterval"),c=r("autoSaveInterval");s==="main"?(n.main=Math.min(Math.max(Math.trunc(Number(i.value)),10),1e3),n.main>n.numbers&&(n.numbers=n.main)):s==="numbers"?(n.numbers=Math.min(Math.max(Math.trunc(Number(l.value)),10),1e3),n.numbers<n.main&&(n.main=n.numbers)):s==="visual"?n.visual=Math.min(Math.max(Math.trunc(Number(f.value)*10)/10,.2),10):s==="autoSave"&&(n.autoSave=Math.min(Math.max(Math.trunc(Number(c.value)),10),1800)),i.value=String(n.main),l.value=String(n.numbers),f.value=String(n.visual),c.value=String(n.autoSave)}clearInterval(t.main),clearInterval(t.numbers),clearInterval(t.visual),clearInterval(t.autoSave),e||(t.main=setInterval(U,n.main),t.numbers=setInterval(D,n.numbers),t.visual=setInterval(ee,n.visual*1e3),t.autoSave=setInterval(j,n.autoSave*1e3,"save"))}async function j(e){switch(e){case"load":{let s=r("file"),n=s.files;if(n===null)return x("Loaded file wasn't found, somehow");let t=await n[0].text();try{let i=JSON.parse(atob(t)),l=Object.hasOwn(i,"player")?i.player.version:i.version;O(!0),ue(i);let f=Date.now()-a.time.updated;r("isSaved").textContent="Imported",o.timeSpecial.lastSave=0,a.toggles.normal[0]?x(`This save is ${d(f,0,"time")} old${f>F()*1e3?`, max offline time is ${o.timeSpecial.maxOffline/3600} hours`:""}.${l!==a.version?`
Also save file version is ${l}, while game version is ${a.version}, ${o.versionInfo.log}`:`
Save file version is ${a.version}`}`):await L(`This save file was set to have offline progress disabled (currently ${d(f,0,"time")}${f>F()*1e3?`, max is ${o.timeSpecial.maxOffline/3600} hours`:""}). Press confirm to NOT to gain offline time.${l!==a.version?`
Also save file version is ${l}, while game version is ${a.version}, ${o.versionInfo.log}`:`
Save file version is ${a.version}`}`)&&(o.timeSpecial.lastSave+=f,a.time.updated=Date.now()),fe()}catch(i){O(),x(`Incorrect save file format.
Full error is: '${i}'`)}finally{s.value=""}return}case"save":{try{let s=btoa(JSON.stringify(a));localStorage.setItem("save",s),r("isSaved").textContent="Saved",o.timeSpecial.lastSave=0}catch(s){x(`Failed to save file.
Full error is: '${s}'`)}return}case"export":{await j("save");let s=btoa(JSON.stringify(a));s!==localStorage.getItem("save")&&x("For some reason save file in a browser and exported one are different..."),r("isSaved").textContent="Exported";let n=document.createElement("a");n.href="data:text/plain;charset=utf-8,"+s,n.download="Fundamental.txt",n.click();return}case"delete":{let s=await le(`This will truly delete your save file and clear local storage!
Type 'delete' to confirm.`);(s==null?void 0:s.toLowerCase())==="delete"?(O(!0),localStorage.clear(),se(),Y(!1,"toggle","reload"),Z(),I("settings","settings"),I("stage"),Object.assign(a,oe("p")),Object.assign(o,oe("g")),a.time.started=Date.now(),a.time.updated=a.time.started,fe()):s!==null&&s!==""&&x(`You wrote '${s}', so save file wasn't deleted`);break}}}var $e=async()=>{O(!0);let e=await le(`Game is currently paused. Press any button bellow to unpause it. If you want you can enter 'NoOffline' to NOT to gain offline time. (Max offline time is ${F()/3600} hours)`);(e==null?void 0:e.toLowerCase())==="nooffline"?a.time.updated=Date.now():e!==null&&e!==""&&x(`You wrote '${e}', so you gained offline time`),O()};})();
//# sourceMappingURL=Code.js.map
